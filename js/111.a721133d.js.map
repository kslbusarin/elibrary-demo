{"version":3,"file":"js/111.a721133d.js","mappings":"qMAEIA,EAAAA,EAAAA,GAAqC,UAAjC,gCAA4B,G,8DADlCC,EAAAA,EAAAA,IASM,YARJC,EACWC,EAAAC,WAAQ,WAAnBH,EAAAA,EAAAA,IAGM,MAAAI,EAAA,EAFJL,EAAAA,EAAAA,GAAiC,UAA7B,aAASM,EAAAA,EAAAA,IAAGH,EAAAI,KAAKC,MAAI,IACzBR,EAAAA,EAAAA,GAAuC,UAA9BS,QAAKC,EAAA,KAAAA,EAAA,OAAAC,IAAEC,EAAAC,QAAAD,EAAAC,UAAAF,KAAQ,eAAM,WAEhCV,EAAAA,EAAAA,IAEM,MAAAa,EAAA,EADJd,EAAAA,EAAAA,GAAmD,UAA1CS,QAAKC,EAAA,KAAAA,EAAA,OAAAC,IAAEC,EAAAG,OAAAH,EAAAG,SAAAJ,KAAO,2B,eAU7B,GACEK,OACE,MAAO,CACLZ,UAAU,EACVG,KAAM,CAAC,EAEX,EACAU,QAAS,CACPF,QACEG,OAAOC,SAASC,KAAO,4LACzB,EACAP,SAEEQ,EAAAA,EAAAA,KAAW,eACRC,MAAK,KACJC,KAAKnB,UAAW,EAChBmB,KAAKhB,KAAO,CAAC,CAAC,IAEfiB,OAAMC,IACLC,QAAQC,IAAIF,EAAM,GAExB,EACAG,YAAYC,GACVH,QAAQC,IAAI,eACZN,EAAAA,EAAAA,SAAAA,QAAAA,OAAAA,+BAA+D,IAC/D,IAAIS,EAAS,CACXC,OAAQ,MACRC,IAAK,yCACLC,QAAS,CACP,cAAiB,UAAYJ,KAIjCR,EAAAA,EAAAA,GAAMS,GACLR,MAAK,SAAUY,GACdR,QAAQC,IAAIQ,KAAKC,UAAUF,EAASlB,MACtC,IACCQ,OAAM,SAAUC,GACfC,QAAQC,IAAIF,EACd,GACF,EACAY,iBACE,MAAMC,EAAO,IAAIC,gBAAgBrB,OAAOC,SAASqB,QAAQC,IAAI,QAC7Df,QAAQC,IAAI,UAAUW,GACjBA,GAGLjB,EAAAA,EAAAA,KAAW,uCAAwC,CACjDiB,KAAMA,EACNI,aAAc,kDACdC,WAAY,qBACZC,UAAW,eACXC,cAAe,qCAEdvB,MAAKY,IACJ,MAAML,EAAcK,EAASlB,KAAK8B,aAClCpB,QAAQC,IAAIE,GACZN,KAAKK,YAAYC,EAAY,IAE9BL,OAAMC,IACLC,QAAQC,IAAIF,EAAM,GAExB,GAEFsB,UACExB,KAAKc,gBACP,G,QC/EF,MAAMW,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://elibrary-vue/./src/views/AuthenView.vue","webpack://elibrary-vue/./src/views/AuthenView.vue?ee66"],"sourcesContent":["<template>\n  <div>\n    <h1>Authentication with OAuth2.0</h1>\n    <div v-if=\"loggedIn\">\n      <h2>Welcome, {{ user.name }}</h2>\n      <button @click=\"logout\">Logout</button>\n    </div>\n    <div v-else>\n      <button @click=\"login\">Login with OAuth2.0</button>\n    </div>\n  </div>\n</template>\n\n<script>\n\n// @ is an alias to /src\n// import HelloWorld from '@/components/HelloWorld.vue'\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      loggedIn: false,\n      user: {}\n    }\n  },\n  methods: {\n    login() {\n      window.location.href = 'https://oauth.psu.ac.th/?oauth=authorize&client_id=oauthpsu1647&response_type=code&scope=profilepsu&redirect_uri=https%3A%2F%2Fread.libx.psu.ac.th%2Fpsupassportcallback&respond_type=code';\n    },\n    logout() {\n      // Call your API's logout endpoint and clear user data\n      axios.post('/api/logout')\n        .then(() => {\n          this.loggedIn = false;\n          this.user = {};\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n    getUserData(accessToken) {\n      console.log(\"Call header\")\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      var config = {\n        method: 'get',\n        url: 'https://oauth.psu.ac.th/?oauth=profile',\n        headers: { \n          'authorization': 'Bearer ' + accessToken\n        }\n      };\n\n      axios(config)\n      .then(function (response) {\n        console.log(JSON.stringify(response.data));\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    },\n    handleCallback() {\n      const code = new URLSearchParams(window.location.search).get('code');\n      console.log(\"code : \"+code)\n      if (!code) {\n        return;\n      }\n      axios.post('https://oauth.psu.ac.th/?oauth=token', {\n        code: code,\n        redirect_uri: 'https://read.libx.psu.ac.th/psupassportcallback',\n        grant_type: 'authorization_code',\n        client_id: 'oauthpsu1647',\n        client_secret: 'b3bbcf8a3bf47c7d3f02e562dfd382cc'\n      })\n        .then(response => {\n          const accessToken = response.data.access_token;\n          console.log(accessToken)\n          this.getUserData(accessToken);\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    }\n  },\n  mounted() {\n    this.handleCallback();\n  }\n}\n</script>\n","import { render } from \"./AuthenView.vue?vue&type=template&id=7ec8ad3c\"\nimport script from \"./AuthenView.vue?vue&type=script&lang=js\"\nexport * from \"./AuthenView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/busarin/Develop/KYL/elibrary_front_vue/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","_createElementBlock","_hoisted_1","$data","loggedIn","_hoisted_2","_toDisplayString","user","name","onClick","_cache","args","$options","logout","_hoisted_3","login","data","methods","window","location","href","axios","then","this","catch","error","console","log","getUserData","accessToken","config","method","url","headers","response","JSON","stringify","handleCallback","code","URLSearchParams","search","get","redirect_uri","grant_type","client_id","client_secret","access_token","mounted","__exports__","render"],"sourceRoot":""}